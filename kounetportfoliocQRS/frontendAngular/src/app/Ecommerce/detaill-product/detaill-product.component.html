<div class="product-details-container">
  <nav class="breadcrumb-nav">
    <span>Accueil</span>
    <span>/</span>
    <span>Détails du produit</span>
  </nav>
  <h1 class="details-title">Détails du produit</h1>

  <div class="details-flex">
    <!-- Galerie images -->
    <div class="gallery">
      <!-- Miniatures -->
      <div class="thumbnails">
        <img *ngFor="let img of images; let idx = index"
             [src]="img"
             [class.selected]="idx === selectedImageIndex"
             (click)="selectImage(idx)"
             class="thumbnail-img"
             [alt]="'Miniature produit ' + (idx + 1)" />
      </div>
      <!-- Image principale -->
      <div class="main-image">
        <button class="arrow left"
                (click)="selectImage((selectedImageIndex - 1 + images.length) % images.length)">
          &#8249;
        </button>
        <img [src]="images[selectedImageIndex]" alt="Image sélectionnée" class="main-img" />
        <button class="arrow right"
                (click)="selectImage((selectedImageIndex + 1) % images.length)">
          &#8250;
        </button>
      </div>
    </div>

    <!-- Informations produit -->
    <div class="details-info">
      <div class="category-text">ACCESSOIRES</div>
      <h2 class="product-title">{{ product?.name }}</h2>
      <div class="rating-row">
        <span class="stars">
          <ng-container *ngFor="let s of fiveStars; let i = index">
            <mat-icon [ngClass]="{'star-filled': i < 4.5}">star</mat-icon>
          </ng-container>
        </span>
        <span class="rating-value">4.5</span>
        <span class="review-count">42 avis</span>
      </div>
      <div class="price-card">
        <span class="main-price">249,99 €</span>
        <span class="old-price">299,99 €</span>
        <div class="discount-badge">Économisez 17%</div>
        <div class="stock-info">
          <mat-icon color="success" class="stock-icon">check_circle</mat-icon>
          En stock <span class="stock-count">(24 articles restants)</span>
        </div>
      </div>
      <div class="desc-text">
        Ce vêtement allie style moderne et culture africaine. Confectionné avec soin, il convient aussi bien aux événements traditionnels qu'aux sorties urbaines.
      </div>

      <!-- Couleurs -->
      <div class="option-row">
        <span class="option-label">Couleur</span>
        <div class="color-options">
          <button *ngFor="let color of colors; let i = index"
                  class="color-circle"
                  [class.selected]="color.selected"
                  [ngStyle]="{'background-color': color.value}"
                  (click)="selectColor(i)">
            <span *ngIf="color.selected" class="color-check">&#10003;</span>
          </button>
        </div>
        <span class="color-name">{{ selectedColorName }}</span>
      </div>

      <!-- Tailles -->
      <div class="option-row">
        <span class="option-label">Taille</span>
        <div class="size-options">
          <button *ngFor="let s of productSize"
                  class="size-btn"
                  [class.selected]="selectedSize === s.sizeProd"
                  (click)="selectSize(s.sizeProd)">
            {{ s.sizeProd }} — {{ s.price }} €
          </button>
        </div>
        <span class="size-name">{{ selectedSize }}</span>
      </div>

      <!-- Quantité -->
      <div class="option-row">
        <span class="option-label">Quantité</span>
        <div class="qty-control">
          <button (click)="decrementQty()">-</button>
          <span>{{ quantity }}</span>
          <button (click)="incrementQty()">+</button>
        </div>
      </div>

      <!-- Boutons d'action -->
      <div class="cta-row">
        <button class="btn btn-primary big-btn" (click)="addToCart()">
          <mat-icon>shopping_cart</mat-icon> Ajouter au panier
        </button>
        <button class="btn btn-outline-primary big-btn">
          <mat-icon>flash_on</mat-icon> Acheter maintenant
        </button>
        <button class="btn btn-outline-secondary favorite-btn">
          <mat-icon>favorite_border</mat-icon>
        </button>
      </div>

      <div class="info-row">
        <div class="info-block">
          <mat-icon>local_shipping</mat-icon>
          <span>
            <span class="info-title">Livraison gratuite</span>
            <span class="info-text">Pour les commandes de plus de 50 €</span>
          </span>
        </div>
        <div class="info-block">
          <mat-icon>autorenew</mat-icon>
          <span>
            <span class="info-title">Retours sous 30 jours</span>
            <span class="info-text">Retour facile et rapide</span>
          </span>
        </div>
        <div class="info-block">
          <mat-icon>verified_user</mat-icon>
          <span>
            <span class="info-title">Garantie 2 ans</span>
            <span class="info-text">Protection complète</span>
          </span>
        </div>
      </div>
      <div *ngIf="addedMessage" class="alert alert-success mt-2">{{ addedMessage }}</div>
    </div>
  </div>

  <!-- Onglets supplémentaires -->
  <div class="mt-5">
    <mat-tab-group>
      <mat-tab label="Présentation du produit">
        <div class="mt-3">
          <h1>{{ product?.name }}</h1>
          <p>{{ product?.description }}</p>
        </div>
      </mat-tab>

      <mat-tab label="Caractéristiques techniques">
        <div class="mt-3 d-flex flex-wrap gap-4">
          <div>
            <table class="table table-bordered">
              <tr><th>Matière</th><td>Coton biologique, Wax africain</td></tr>
              <tr><th>Entretien</th><td>Lavable à 30°C</td></tr>
              <tr><th>Fabrication</th><td>Fait main, Cameroun</td></tr>
              <tr><th>Poids</th><td>250 g</td></tr>
            </table>
          </div>
          <div>
            <table class="table table-bordered">
              <tr><th>Disponible pour</th><td>Hommes et Femmes</td></tr>
              <tr><th>Tailles</th><td>Du S au XXL</td></tr>
              <tr><th>Livraison</th><td>5 à 7 jours ouvrables</td></tr>
            </table>
          </div>
        </div>
      </mat-tab>

      <mat-tab label="Avis (42)">
        <div class="mt-3">
          <div class="review-summary mb-4">
            <span style="font-size: 2.5rem; font-weight: bold;">4.5</span>
            <span class="text-warning ms-2">
              <i class="bi bi-star-fill"></i>
              <i class="bi bi-star-fill"></i>
              <i class="bi bi-star-fill"></i>
              <i class="bi bi-star-fill"></i>
              <i class="bi bi-star-half"></i>
            </span>
            <span class="ms-2">(42 avis)</span>
          </div>

          <div *ngFor="let review of reviews" class="mb-4 p-3 border rounded shadow-sm">
            <div>
              <b>{{review.author}}</b> <span class="text-muted">{{review.date}}</span>
              <span class="ms-3 text-warning">
                <ng-container *ngFor="let star of fiveStars; let i = index">
                  <i class="bi" [ngClass]="i < review.rating ? 'bi-star-fill' : 'bi-star'"></i>
                </ng-container>
              </span>
            </div>
            <div>{{review.text}}</div>
          </div>

          <div class="mt-4">
            <h5>Laisser un avis</h5>
            <form>
              <div class="mb-2">
                <label>Votre note :</label>
                <span class="text-warning">
                  <i class="bi bi-star-fill"></i>
                  <i class="bi bi-star-fill"></i>
                  <i class="bi bi-star-fill"></i>
                  <i class="bi bi-star-fill"></i>
                  <i class="bi bi-star-fill"></i>
                </span>
              </div>
              <div class="mb-2 d-flex gap-2">
                <input type="text" class="form-control" placeholder="Votre nom" />
                <input type="email" class="form-control" placeholder="Votre email" />
              </div>
              <div class="mb-2">
                <input type="text" class="form-control" placeholder="Titre de l’avis" />
              </div>
              <div class="mb-2">
                <textarea class="form-control" rows="3" placeholder="Votre commentaire"></textarea>
              </div>
              <button type="button" class="btn btn-primary">Soumettre l’avis</button>
            </form>
          </div>
        </div>
      </mat-tab>
    </mat-tab-group>
  </div>
</div>
